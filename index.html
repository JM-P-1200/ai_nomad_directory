<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NomadAI.tools — Curated AI tools for digital nomads</title>
  <meta name="description" content="Curated AI tools for digital nomads — travel, productivity, finance, content, and development.">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {padding-bottom:60px}
    .card:hover {transform: translateY(-6px); transition: .18s ease}
    .tag {cursor:pointer}
    .logo {width:48px;height:48px;object-fit:contain}
    .no-results {padding:80px 0;text-align:center;color:#666}
    .admin-link {font-size:0.9rem}
  </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container">
    <a class="navbar-brand" href="#">NomadAI.tools</a>
    <div class="d-flex">
      <a class="nav-link text-light admin-link" href="/admin/">Admin</a>
    </div>
  </div>
</nav>

<header class="py-5 bg-light border-bottom">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-8">
        <h1 class="h2 mb-2">Nomad AI Tools — curated for digital nomads</h1>
        <p class="mb-0">Find AI tools for productivity, travel planning, growth hacking, content and code — with pricing, use-case and region notes.</p>
      </div>
      <div class="col-md-4 mt-3 mt-md-0">
        <div class="input-group">
          <input id="search" class="form-control" placeholder="Search tools, e.g. 'travel' or 'notion'">
          <button id="clearSearch" class="btn btn-outline-secondary">Clear</button>
        </div>
      </div>
    </div>
    <div class="row mt-3">
      <div class="col-12">
        <div id="tag-list"></div>
      </div>
    </div>
  </div>
</header>

<main class="container my-4">
  <div class="row">
    <div class="col-lg-3 mb-4">
      <div class="card p-3 sticky-top" style="top:20px">
        <h6>Filters</h6>
        <div class="mb-3">
          <label class="form-label">Category</label>
          <select id="categoryFilter" class="form-select">
            <option value="all">All</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Pricing</label>
          <select id="pricingFilter" class="form-select">
            <option value="all">All</option>
            <option value="free">Free</option>
            <option value="freemium">Freemium</option>
            <option value="paid">Paid</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Sort</label>
          <select id="sortBy" class="form-select">
            <option value="featured">Featured</option>
            <option value="name">Name A–Z</option>
            <option value="newest">Newest</option>
          </select>
        </div>
        <button id="resetFilters" class="btn btn-sm btn-outline-secondary w-100">Reset</button>
      </div>
    </div>

    <div class="col-lg-9">
      <div id="grid" class="row g-3"></div>
      <div id="noResults" class="no-results d-none">No tools match your search.</div>
    </div>
  </div>

  <section id="about" class="mt-5">
    <h4>About</h4>
    <p>This is a production-ready starter for a directory of AI tools for digital nomads. Edits should be done through <a href="/admin/">Admin (Netlify CMS)</a>.</p>
  </section>

  <section id="submit" class="mt-4">
    <h4>Submit a tool</h4>
    <p>Submit via the Admin panel or open a PR on GitHub in the <code>content/tools/</code> folder.</p>
  </section>
</main>

<footer class="bg-dark text-light py-4 mt-5">
  <div class="container text-center small">© NomadAI.tools — Curated directory • Built with Bootstrap</div>
</footer>

<!-- Modal -->
<div class="modal fade" id="toolModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="modalTitle" class="modal-title"></h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <p id="modalDesc"></p>
        <ul id="modalMeta" class="list-unstyled small"></ul>
      </div>
      <div class="modal-footer">
        <a id="modalVisit" class="btn btn-primary" target="_blank" href="#">Visit site</a>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
// Fetch data/tools.json, fallback to embedded sample when missing
async function loadTools() {
  try {
    const resp = await fetch('/data/tools.json', {cache: "no-store"});
    if(!resp.ok) throw new Error('no json');
    const data = await resp.json();
    return data;
  } catch (e) {
    // fallback sample
    return [
      {"id":1,"name":"RoamTrip AI","desc":"AI travel assistant focused on itinerary building, local sim tips and co-working spots.","url":"https://example.com/roamtrip","tags":["travel","itinerary","nomad"],"pricing":"freemium","category":"Travel","featured":true,"region":"Global","added":"2025-06-01"},
      {"id":2,"name":"PocketCoder AI","desc":"Generates code snippets, fixes bugs and sets up tiny serverless endpoints — great on phones.","url":"https://example.com/pocketcoder","tags":["code","developer","automation"],"pricing":"paid","category":"Development","featured":true,"region":"Global","added":"2025-02-14"},
      {"id":3,"name":"NomadInvoice","desc":"Create simple invoices in seconds — multi-currency and GCash / PayPal notes for PH nomads.","url":"https://example.com/nomadinvoice","tags":["finance","invoicing","payments"],"pricing":"free","category":"Finance","featured":false,"region":"Philippines","added":"2024-11-20"},
      {"id":4,"name":"BrieflyAI Pack","desc":"Content briefing and drafts for blogs, micro-posts and newsletters. Fast templates for Beehiiv + Gumroad.","url":"https://example.com/briefly","tags":["content","marketing","newsletter"],"pricing":"freemium","category":"Content","featured":false,"region":"Global","added":"2025-03-10"},
      {"id":5,"name":"CoWork Finder","desc":"Finds co-working spaces and checks signal strength reports from other nomads.","url":"https://example.com/cowork","tags":["cowork","workspace","signal"],"pricing":"free","category":"Travel","featured":false,"region":"SEA","added":"2024-09-05"}
    ];
  }
}

function sanitize(s){ return s || ''; }

function buildControls(tools){
  const tags = new Set();
  const categories = new Set();
  tools.forEach(t => { (t.tags||[]).forEach(tag=>tags.add(tag)); categories.add(t.category||'Other'); });
  const tagListEl = document.getElementById('tag-list');
  tagListEl.innerHTML = '';
  [...tags].sort().forEach(t=>{ const span = document.createElement('span'); span.className='badge bg-secondary me-2 mb-2 tag'; span.textContent = t; span.dataset.tag = t; span.onclick = ()=>{ document.getElementById('search').value = t; applyFilters(tools); }; tagListEl.appendChild(span); });
  const categoryFilter = document.getElementById('categoryFilter');
  [...categories].sort().forEach(c => { const o = document.createElement('option'); o.value=c; o.textContent=c; categoryFilter.appendChild(o); });
}

function renderGrid(data){
  const grid = document.getElementById('grid');
  const noResults = document.getElementById('noResults');
  grid.innerHTML = '';
  if(!data.length){ noResults.classList.remove('d-none'); return; }
  noResults.classList.add('d-none');
  data.forEach(tool => {
    const col = document.createElement('div'); col.className='col-md-6 col-lg-4';
    const card = document.createElement('div'); card.className='card h-100';
    const body = document.createElement('div'); body.className='card-body d-flex';
    const left = document.createElement('div'); left.className='me-3';
    const img = document.createElement('img'); img.src = tool.logo || 'https://via.placeholder.com/64?text=' + encodeURIComponent((tool.name||'').split(' ')[0]); img.className='logo rounded';
    left.appendChild(img);
    const right = document.createElement('div'); right.className='flex-1';
    const h5 = document.createElement('h5'); h5.className='card-title h6'; h5.textContent = tool.name;
    const p = document.createElement('p'); p.className='card-text small text-muted mb-2'; p.textContent = tool.desc;
    const meta = document.createElement('div'); meta.className='mb-2';
    (tool.tags||[]).slice(0,3).forEach(t=>{ const s = document.createElement('span'); s.className='badge bg-light text-dark me-1 small'; s.textContent=t; meta.appendChild(s); });
    const footer = document.createElement('div'); footer.className='mt-auto d-flex justify-content-between align-items-center';
    const more = document.createElement('button'); more.className='btn btn-sm btn-outline-primary'; more.textContent='Details'; more.onclick = ()=>openModal(tool);
    const visit = document.createElement('a'); visit.className='btn btn-sm btn-primary'; visit.href = tool.url; visit.target='_blank'; visit.textContent='Open';
    right.appendChild(h5); right.appendChild(p); right.appendChild(meta); footer.appendChild(more); footer.appendChild(visit);
    body.appendChild(left); body.appendChild(right);
    card.appendChild(body); col.appendChild(card); grid.appendChild(col);
  });
}

function openModal(tool){
  document.getElementById('modalTitle').textContent = tool.name;
  document.getElementById('modalDesc').textContent = tool.desc;
  const meta = document.getElementById('modalMeta'); meta.innerHTML = '';
  [['Pricing', tool.pricing],['Category', tool.category],['Region', tool.region],['Added', tool.added]].forEach(([k,v])=>{
    const li = document.createElement('li'); li.innerHTML = '<strong>'+k+':</strong> '+(v||''); meta.appendChild(li);
  });
  document.getElementById('modalVisit').href = tool.url || '#';
  const modal = new bootstrap.Modal(document.getElementById('toolModal')); modal.show();
}

function applyFilters(allTools){
  const q = (document.getElementById('search').value || '').trim().toLowerCase();
  const cat = document.getElementById('categoryFilter').value;
  const price = document.getElementById('pricingFilter').value;
  const sort = document.getElementById('sortBy').value;
  let res = (allTools||[]).filter(t=>{
    if(cat && cat!=='all' && (t.category||'')!==cat) return false;
    if(price && price!=='all' && (t.pricing||'')!==price) return false;
    if(q){
      const inFields = ((t.name||'') + ' ' + (t.desc||'') + ' ' + ((t.tags||[]).join(' '))).toLowerCase();
      if(!inFields.includes(q)) return false;
    }
    return true;
  });
  if(sort==='name') res.sort((a,b)=> (a.name||'').localeCompare(b.name||''));
  if(sort==='newest') res.sort((a,b)=> new Date(b.added || 0) - new Date(a.added || 0));
  if(sort==='featured') res.sort((a,b)=> (b.featured?1:0) - (a.featured?1:0));
  renderGrid(res);
}

document.addEventListener('DOMContentLoaded', async ()=>{
  const tools = await loadTools();
  buildControls(tools);
  applyFilters(tools);
  document.getElementById('search').addEventListener('input', ()=>applyFilters(tools));
  document.getElementById('clearSearch').addEventListener('click', ()=>{ document.getElementById('search').value=''; applyFilters(tools); });
  document.getElementById('categoryFilter').addEventListener('change', ()=>applyFilters(tools));
  document.getElementById('pricingFilter').addEventListener('change', ()=>applyFilters(tools));
  document.getElementById('sortBy').addEventListener('change', ()=>applyFilters(tools));
  document.getElementById('resetFilters').addEventListener('click', ()=>{ document.getElementById('categoryFilter').value='all'; document.getElementById('pricingFilter').value='all'; document.getElementById('sortBy').value='featured'; document.getElementById('search').value=''; applyFilters(tools); });
});
</script>
</body>
</html>
